<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hibt - Trading Platform</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f8f9fa; }
        
        .auth-container { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .auth-box { background: white; border-radius: 20px; padding: 40px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); width: 90%; max-width: 400px; }
        .auth-title { font-size: 24px; font-weight: 600; margin-bottom: 30px; text-align: center; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #555; font-weight: 500; }
        input, select { width: 100%; padding: 15px; border: 2px solid #e1e5e9; border-radius: 12px; font-size: 16px; }
        input:focus, select:focus { outline: none; border-color: #667eea; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 20px; }
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5a67d8; }
        .switch-text { margin-top: 20px; color: #6c757d; text-align: center; }
        .switch-link { color: #667eea; cursor: pointer; text-decoration: underline; }
        .message { padding: 10px; border-radius: 8px; margin-bottom: 15px; font-weight: 500; }
        .error { background: #fee; color: #c33; border: 1px solid #fcc; }
        .success { background: #efe; color: #363; border: 1px solid #cfc; }
        .hidden { display: none; }
        
        .dashboard { display: none; min-height: 100vh; }
        .dashboard.active { display: block; }
        .header { background: linear-gradient(135deg, #4285f4 0%, #3367d6 100%); color: white; padding: 20px; }
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .brand { font-size: 36px; font-weight: bold; }
        .user-info-box { background: rgba(255,255,255,0.2); padding: 15px; border-radius: 12px; margin-top: 15px; }
        .user-id { font-size: 14px; opacity: 0.9; margin-bottom: 5px; }
        .user-name { font-size: 18px; font-weight: 600; margin-bottom: 10px; }
        .balance-display { font-size: 32px; font-weight: bold; margin: 10px 0; }
        .btn-group { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .btn-small { padding: 8px 16px; background: rgba(255,255,255,0.2); border: none; border-radius: 20px; color: white; cursor: pointer; font-size: 14px; }
        .btn-small:hover { background: rgba(255,255,255,0.3); }
        
        .market-section { padding: 20px; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .section-title { font-size: 24px; font-weight: bold; }
        .coin-list { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .coin-item { display: flex; align-items: center; padding: 16px 20px; border-bottom: 1px solid #f1f3f4; cursor: pointer; }
        .coin-item:hover { background: #f8f9fb; }
        .coin-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; margin-right: 15px; font-size: 14px; }
        .coin-info { flex: 1; }
        .coin-name { font-weight: 600; font-size: 16px; }
        .coin-price { text-align: right; font-weight: 600; font-size: 16px; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto; }
        .modal.active { display: flex; justify-content: center; align-items: center; padding: 20px; }
        .modal-content { background: white; border-radius: 20px; padding: 30px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-title { font-size: 24px; font-weight: 600; }
        .close-btn { background: none; border: none; font-size: 32px; cursor: pointer; color: #666; line-height: 1; }
        .trade-section { margin-bottom: 20px; }
        .trade-label { font-weight: 600; margin-bottom: 10px; }
        .direction-btns { display: flex; gap: 10px; margin-top: 10px; }
        .direction-btn { flex: 1; padding: 15px; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; }
        .direction-btn.up { background: #4caf50; color: white; }
        .direction-btn.down { background: #f44336; color: white; }
        .direction-btn.inactive { background: #e9ecef; color: #666; }
        .percentage-btns { display: flex; gap: 10px; margin-top: 10px; }
        .percentage-btn { flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 12px; background: white; cursor: not-allowed; font-weight: 600; }
        .percentage-btn.active { background: #4285f4; color: white; border-color: #4285f4; }
        .trade-input { width: 100%; padding: 15px; border: 2px solid #e9ecef; border-radius: 12px; font-size: 16px; margin-top: 10px; }
        .info-text { color: #666; font-size: 14px; margin-top: 10px; }
        .trade-btn { width: 100%; padding: 18px; background: #4285f4; color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: 600; cursor: pointer; margin-top: 20px; }
        .trade-btn:hover { background: #3367d6; }
        
        .tab-container { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { flex: 1; padding: 12px; background: #f0f0f0; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
        .tab.active { background: #4285f4; color: white; }
        .history-list { margin-top: 20px; max-height: 400px; overflow-y: auto; }
        .history-item { background: white; padding: 15px; border-radius: 12px; margin-bottom: 10px; cursor: pointer; }
        .history-item.wait { border-left: 4px solid #ff9800; background: #fff8f0; }
        .history-item.finished.win { border-left: 4px solid #4caf50; background: #f1f8f4; }
        .history-item.finished.loss { border-left: 4px solid #f44336; background: #fef1f1; }
        .history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .history-coin { font-weight: 600; font-size: 16px; }
        .history-time { font-size: 12px; color: #666; }
        .countdown { font-size: 16px; font-weight: 600; color: #ff9800; }
        .history-profit { font-size: 14px; color: #4caf50; font-weight: 600; margin-top: 8px; }
        .history-loss { font-size: 14px; color: #f44336; font-weight: 600; margin-top: 8px; }
        .detail-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f0f0f0; }
        .detail-label { color: #666; }
        .detail-value { font-weight: 600; }
        .detail-value.up { color: #4caf50; }
        .detail-value.down { color: #f44336; }
        .detail-value.profit { color: #4caf50; font-size: 18px; }
        .detail-value.red { color: #f44336; font-size: 18px; }
        
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .stat-card { background: #f8f9fa; padding: 15px; border-radius: 12px; text-align: center; }
        .stat-label { font-size: 12px; color: #666; margin-bottom: 5px; }
        .stat-value { font-size: 24px; font-weight: bold; color: #333; }
        .stat-value.green { color: #4caf50; }
        .stat-value.red { color: #f44336; }
        
        .deposit-address { background: #f8f9fa; padding: 15px; border-radius: 12px; margin: 15px 0; word-break: break-all; font-family: monospace; font-size: 13px; border: 2px dashed #ddd; }
        .copy-btn { padding: 10px 20px; background: #4285f4; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
        .copy-btn:hover { background: #3367d6; }
        
        .btc { background: #f7931a; }
        .eth { background: #627eea; }
        .xrp { background: #23292f; }
        .doge { background: #c2a633; }
        .ada { background: #0033ad; }
        .bnb { background: #f3ba2f; }
        .sol { background: #9945FF; }
        .link { background: #375BD2; }
        .dot { background: #E6007A; }
        .ltc { background: #345D9D; }
    </style>
</head>
<body>
    <div class="auth-container" id="authContainer">
        <div class="auth-box">
            <div id="registerForm">
                <h2 class="auth-title">Create Account</h2>
                <div id="authMessage"></div>
                <div class="input-group">
                    <label>Full Name</label>
                    <input type="text" id="regName" placeholder="Enter your name">
                </div>
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="regEmail" placeholder="Enter email">
                </div>
                <div class="input-group">
                    <label>Password</label>
                    <input type="password" id="regPassword" placeholder="Enter password">
                </div>
                <button class="btn btn-primary" id="registerBtn">Register</button>
                <div class="switch-text">
                    Already have an account? <span class="switch-link" id="showLoginBtn">Sign In</span>
                </div>
            </div>

            <div id="loginForm" class="hidden">
                <h2 class="auth-title">Sign In</h2>
                <div id="loginMessage"></div>
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="Enter email">
                </div>
                <div class="input-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter password">
                </div>
                <button class="btn btn-primary" id="loginBtn">Sign In</button>
                <div class="switch-text">
                    <span class="switch-link" id="forgotPasswordBtn">Forgot Password?</span>
                </div>
                <div class="switch-text">
                    Don't have an account? <span class="switch-link" id="showRegisterBtn">Register</span>
                </div>
            </div>
        </div>
    </div>

    <div class="dashboard" id="dashboard">
        <div class="header">
            <div class="header-top">
                <div class="brand">Hibt</div>
                <button class="btn-small" id="logoutBtn">Logout</button>
            </div>
            <div class="user-info-box">
                <div class="user-id">ID: <span id="userId"></span></div>
                <div class="user-name" id="userName"></div>
                <div class="balance-display">
                    <span id="userBalance">0.00</span> USDT
                    <div style="font-size: 14px; opacity: 0.9; margin-top: 5px;">Available Balance</div>
                </div>
                <div class="btn-group">
                    <button class="btn-small" id="profileBtn">Profile</button>
                    <button class="btn-small" id="contractBtn">My Contract</button>
                    <button class="btn-small" id="depositBtn">Deposit</button>
                    <button class="btn-small" id="analyticsBtn">Analytics</button>
                </div>
            </div>
        </div>

        <div class="market-section">
            <div class="section-header">
                <h2 class="section-title">Markets</h2>
            </div>
            <div class="coin-list" id="coinList"></div>
        </div>
    </div>

    <!-- Trading Modal -->
    <div class="modal" id="tradingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Trade</h2>
                <button class="close-btn" id="closeTradingBtn">&times;</button>
            </div>
            
            <div id="tradeMessage"></div>
            
            <div class="trade-section">
                <div class="trade-label">Direction</div>
                <div class="direction-btns">
                    <button class="direction-btn up" id="upBtn">Buy Up</button>
                    <button class="direction-btn down inactive" id="downBtn">Buy Down</button>
                </div>
            </div>

            <div class="trade-section">
                <div class="trade-label">Profit Percentage (Auto-set by time)</div>
                <div class="percentage-btns">
                    <button class="percentage-btn active" id="profit15" disabled style="opacity: 0.7;">15%</button>
                    <button class="percentage-btn" id="profit25" disabled style="opacity: 0.7;">25%</button>
                    <button class="percentage-btn" id="profit35" disabled style="opacity: 0.7;">35%</button>
                </div>
                <div class="info-text">Profit percentage is automatically set based on contract time</div>
            </div>

            <div class="trade-section">
                <div class="trade-label">Amount (USDT)</div>
                <input type="number" class="trade-input" id="tradeAmount" placeholder="Enter amount (min 100 USDT)" min="100">
                <div class="info-text">Available: <span id="availableBalance">0.00</span> USDT</div>
                <div class="info-text">Expected Profit: <span id="expectedProfit">0.00</span> USDT</div>
            </div>

            <div class="trade-section">
                <div class="trade-label">Contract Time</div>
                <select class="trade-input" id="timeFrame">
                    <option value="60">60 Seconds (15% Profit)</option>
                    <option value="90">90 Seconds (25% Profit) - Requires 100K+ Balance</option>
                    <option value="120">2 Minutes (35% Profit) - Requires 500K+ Balance</option>
                </select>
                <div class="info-text" id="timeFrameWarning" style="color: #f44336; display: none;">Insufficient balance for this timeframe</div>
            </div>

            <button class="trade-btn" id="executeTradeBtn">Execute Trade</button>
        </div>
    </div>

    <!-- History Modal -->
    <div class="modal" id="historyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">My Contract</h2>
                <button class="close-btn" id="closeHistoryBtn">&times;</button>
            </div>
            <div class="tab-container">
                <button class="tab active" id="waitTab">Wait</button>
                <button class="tab" id="finishedTab">Finished</button>
            </div>
            <div class="history-list" id="historyList"></div>
        </div>
    </div>

    <!-- Trade Detail Modal -->
    <div class="modal" id="tradeDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="detailCoinName">BTC/USDT</h2>
                <button class="close-btn" id="closeDetailBtn">&times;</button>
            </div>
            <div id="tradeDetailContent"></div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Profile</h2>
                <button class="close-btn" id="closeProfileBtn">&times;</button>
            </div>
            <div style="text-align: center; padding: 20px;">
                <div style="font-size: 18px; color: #666; margin-bottom: 10px;">UID: <span id="profileUserId"></span></div>
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 20px;" id="profileUserName"></div>
                <button class="btn btn-primary" id="viewDepositBtn">View Deposit</button>
                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef;">
                    <h3 style="margin-bottom: 15px;">Functions</h3>
                    <div style="text-align: left;">
                        <div style="padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="profileAnalyticsBtn">Analytics</div>
                        <div style="padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="changePasswordBtn">Change Password</div>
                        <div style="padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="contactSupportBtn">Contact Support</div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="settingsBtn">Settings</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div class="modal" id="depositModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Deposit Funds</h2>
                <button class="close-btn" id="closeDepositBtn">&times;</button>
            </div>
            <div style="padding: 20px 0;">
                <div class="trade-section">
                    <div class="trade-label">Select Cryptocurrency</div>
                    <select class="trade-input" id="depositCrypto">
                        <option value="btc">Bitcoin (BTC)</option>
                        <option value="eth">Ethereum (ETH)</option>
                        <option value="other">Other Coins</option>
                    </select>
                </div>

                <div class="trade-section">
                    <div class="trade-label">Deposit Address</div>
                    <div class="deposit-address" id="depositAddress">Select a cryptocurrency</div>
                    <button class="copy-btn" id="copyAddressBtn">Copy Address</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Change Password</h2>
                <button class="close-btn" id="closeChangePasswordBtn">&times;</button>
            </div>
            <div id="changePasswordMessage"></div>
            <div class="input-group">
                <label>Current Password</label>
                <input type="password" id="currentPassword" placeholder="Enter current password">
            </div>
            <div class="input-group">
                <label>New Password</label>
                <input type="password" id="newPassword" placeholder="Enter new password">
            </div>
            <div class="input-group">
                <label>Confirm New Password</label>
                <input type="password" id="confirmPassword" placeholder="Confirm new password">
            </div>
            <button class="btn btn-primary" id="submitChangePasswordBtn">Change Password</button>
        </div>
    </div>

    <!-- Chat Modal -->
    <div class="modal" id="chatModal">
        <div class="modal-content" style="max-width: 600px; height: 600px; display: flex; flex-direction: column;">
            <div class="modal-header">
                <h2 class="modal-title">Support Chat</h2>
                <button class="close-btn" id="closeChatBtn">&times;</button>
            </div>
            <div id="chatMessages" style="flex: 1; overflow-y: auto; padding: 15px; background: #f8f9fa; border-radius: 12px; margin-bottom: 15px;">
                <div style="text-align: center; color: #666; padding: 20px;">Loading messages...</div>
            </div>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="chatInput" placeholder="Type your message..." style="flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 12px;">
                <button class="btn btn-primary" style="width: auto; padding: 12px 24px; margin: 0;" id="sendMessageBtn">Send</button>
            </div>
        </div>
    </div>

    <!-- Analytics Modal -->
    <div class="modal" id="analyticsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Trading Analytics</h2>
                <button class="close-btn" id="closeAnalyticsBtn">&times;</button>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Trades</div>
                    <div class="stat-value" id="totalTrades">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Win Rate</div>
                    <div class="stat-value green" id="winRate">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Profit</div>
                    <div class="stat-value green" id="totalProfit">$0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Loss</div>
                    <div class="stat-value red" id="totalLoss">$0</div>
                </div>
            </div>
            <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 12px;">
                <h3 style="margin-bottom: 15px;">Performance Summary</h3>
                <div id="performanceChart" style="text-align: center; color: #666; padding: 20px;">Trade more to see detailed analytics</div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDWQBTrvvxCL5Qd23iSMTQlWkaPKZgjhqw",
            authDomain: "trading-dapp-d5aa4.firebaseapp.com",
            projectId: "trading-dapp-d5aa4",
            storageBucket: "trading-dapp-d5aa4.firebasestorage.app",
            messagingSenderId: "690266747119",
            appId: "1:690266747119:web:0f22d45fbee53ee3c3eb1a"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let currentUser = null;
        let userBalance = 0;
        let userName = '';
        let userId = '';
        let selectedCoin = null;
        let tradeDirection = 'up';
        let selectedPercentage = 15;
        let historyFilter = 'wait';
        let countdownIntervals = {};
        let balanceUpdateListener = null;
        let chatListener = null;

        const WALLET_ADDRESSES = {
            btc: "bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh",
            eth: "0x71C7656EC7ab88b098defB751B7401B5f6d8976F",
            other: "Contact support for other coins"
        };

        const coins = [
            { name: 'BTC', fullName: 'Bitcoin', class: 'btc', price: 109770.33 },
            { name: 'ETH', fullName: 'Ethereum', class: 'eth', price: 4030.81 },
            { name: 'XRP', fullName: 'Ripple', class: 'xrp', price: 2.8131 },
            { name: 'DOGE', fullName: 'Dogecoin', class: 'doge', price: 0.2309 },
            { name: 'ADA', fullName: 'Cardano', class: 'ada', price: 1.2456 },
            { name: 'BNB', fullName: 'Binance Coin', class: 'bnb', price: 692.45 },
            { name: 'SOL', fullName: 'Solana', class: 'sol', price: 245.67 },
            { name: 'LINK', fullName: 'Chainlink', class: 'link', price: 28.91 },
            { name: 'DOT', fullName: 'Polkadot', class: 'dot', price: 8.92 },
            { name: 'LTC', fullName: 'Litecoin', class: 'ltc', price: 156.78 }
        ];

        function generateUserId() {
            return Math.floor(10000 + Math.random() * 90000).toString();
        }

        function showMessage(elementId, message, type) {
            const el = document.getElementById(elementId);
            if (el) {
                el.innerHTML = '<div class="message ' + type + '">' + message + '</div>';
                setTimeout(function() { el.innerHTML = ''; }, 4000);
            }
        }

        function showRegister() {
            document.getElementById('registerForm').classList.remove('hidden');
            document.getElementById('loginForm').classList.add('hidden');
        }

        function showLogin() {
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('loginForm').classList.remove('hidden');
        }

        function showAuth() {
            document.getElementById('authContainer').style.display = 'flex';
            document.getElementById('dashboard').classList.remove('active');
        }

        function showDashboard() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('dashboard').classList.add('active');
            renderCoins();
        }

        async function register() {
            const name = document.getElementById('regName').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value + totalProfit.toFixed(2);
                document.getElementById('totalLoss').textContent = '<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hibt - Trading Platform</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f8f9fa; }
        
        .auth-container { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .auth-box { background: white; border-radius: 20px; padding: 40px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); width: 90%; max-width: 400px; }
        .auth-title { font-size: 24px; font-weight: 600; margin-bottom: 30px; text-align: center; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #555; font-weight: 500; }
        input, select { width: 100%; padding: 15px; border: 2px solid #e1e5e9; border-radius: 12px; font-size: 16px; }
        input:focus, select:focus { outline: none; border-color: #667eea; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 20px; }
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5a67d8; }
        .switch-text { margin-top: 20px; color: #6c757d; text-align: center; }
        .switch-link { color: #667eea; cursor: pointer; text-decoration: underline; }
        .message { padding: 10px; border-radius: 8px; margin-bottom: 15px; font-weight: 500; }
        .error { background: #fee; color: #c33; border: 1px solid #fcc; }
        .success { background: #efe; color: #363; border: 1px solid #cfc; }
        .hidden { display: none; }
        
        .dashboard { display: none; min-height: 100vh; }
        .dashboard.active { display: block; }
        .header { background: linear-gradient(135deg, #4285f4 0%, #3367d6 100%); color: white; padding: 20px; }
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .brand { font-size: 36px; font-weight: bold; }
        .user-info-box { background: rgba(255,255,255,0.2); padding: 15px; border-radius: 12px; margin-top: 15px; }
        .user-id { font-size: 14px; opacity: 0.9; margin-bottom: 5px; }
        .user-name { font-size: 18px; font-weight: 600; margin-bottom: 10px; }
        .balance-display { font-size: 32px; font-weight: bold; margin: 10px 0; }
        .btn-group { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .btn-small { padding: 8px 16px; background: rgba(255,255,255,0.2); border: none; border-radius: 20px; color: white; cursor: pointer; font-size: 14px; }
        .btn-small:hover { background: rgba(255,255,255,0.3); }
        
        .market-section { padding: 20px; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .section-title { font-size: 24px; font-weight: bold; }
        .coin-list { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .coin-item { display: flex; align-items: center; padding: 16px 20px; border-bottom: 1px solid #f1f3f4; cursor: pointer; }
        .coin-item:hover { background: #f8f9fb; }
        .coin-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; margin-right: 15px; font-size: 14px; }
        .coin-info { flex: 1; }
        .coin-name { font-weight: 600; font-size: 16px; }
        .coin-price { text-align: right; font-weight: 600; font-size: 16px; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto; }
        .modal.active { display: flex; justify-content: center; align-items: center; padding: 20px; }
        .modal-content { background: white; border-radius: 20px; padding: 30px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-title { font-size: 24px; font-weight: 600; }
        .close-btn { background: none; border: none; font-size: 32px; cursor: pointer; color: #666; line-height: 1; }
        .trade-section { margin-bottom: 20px; }
        .trade-label { font-weight: 600; margin-bottom: 10px; }
        .direction-btns { display: flex; gap: 10px; margin-top: 10px; }
        .direction-btn { flex: 1; padding: 15px; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; }
        .direction-btn.up { background: #4caf50; color: white; }
        .direction-btn.down { background: #f44336; color: white; }
        .direction-btn.inactive { background: #e9ecef; color: #666; }
        .percentage-btns { display: flex; gap: 10px; margin-top: 10px; }
        .percentage-btn { flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 12px; background: white; cursor: not-allowed; font-weight: 600; }
        .percentage-btn.active { background: #4285f4; color: white; border-color: #4285f4; }
        .trade-input { width: 100%; padding: 15px; border: 2px solid #e9ecef; border-radius: 12px; font-size: 16px; margin-top: 10px; }
        .info-text { color: #666; font-size: 14px; margin-top: 10px; }
        .trade-btn { width: 100%; padding: 18px; background: #4285f4; color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: 600; cursor: pointer; margin-top: 20px; }
        .trade-btn:hover { background: #3367d6; }
        
        .tab-container { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { flex: 1; padding: 12px; background: #f0f0f0; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
        .tab.active { background: #4285f4; color: white; }
        .history-list { margin-top: 20px; max-height: 400px; overflow-y: auto; }
        .history-item { background: white; padding: 15px; border-radius: 12px; margin-bottom: 10px; cursor: pointer; }
        .history-item.wait { border-left: 4px solid #ff9800; background: #fff8f0; }
        .history-item.finished.win { border-left: 4px solid #4caf50; background: #f1f8f4; }
        .history-item.finished.loss { border-left: 4px solid #f44336; background: #fef1f1; }
        .history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .history-coin { font-weight: 600; font-size: 16px; }
        .history-time { font-size: 12px; color: #666; }
        .countdown { font-size: 16px; font-weight: 600; color: #ff9800; }
        .history-profit { font-size: 14px; color: #4caf50; font-weight: 600; margin-top: 8px; }
        .history-loss { font-size: 14px; color: #f44336; font-weight: 600; margin-top: 8px; }
        .detail-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f0f0f0; }
        .detail-label { color: #666; }
        .detail-value { font-weight: 600; }
        .detail-value.up { color: #4caf50; }
        .detail-value.down { color: #f44336; }
        .detail-value.profit { color: #4caf50; font-size: 18px; }
        .detail-value.red { color: #f44336; font-size: 18px; }
        
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .stat-card { background: #f8f9fa; padding: 15px; border-radius: 12px; text-align: center; }
        .stat-label { font-size: 12px; color: #666; margin-bottom: 5px; }
        .stat-value { font-size: 24px; font-weight: bold; color: #333; }
        .stat-value.green { color: #4caf50; }
        .stat-value.red { color: #f44336; }
        
        .deposit-address { background: #f8f9fa; padding: 15px; border-radius: 12px; margin: 15px 0; word-break: break-all; font-family: monospace; font-size: 13px; border: 2px dashed #ddd; }
        .copy-btn { padding: 10px 20px; background: #4285f4; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
        .copy-btn:hover { background: #3367d6; }
        
        .btc { background: #f7931a; }
        .eth { background: #627eea; }
        .xrp { background: #23292f; }
        .doge { background: #c2a633; }
        .ada { background: #0033ad; }
        .bnb { background: #f3ba2f; }
        .sol { background: #9945FF; }
        .link { background: #375BD2; }
        .dot { background: #E6007A; }
        .ltc { background: #345D9D; }
    </style>
</head>
<body>
    <div class="auth-container" id="authContainer">
        <div class="auth-box">
            <div id="registerForm">
                <h2 class="auth-title">Create Account</h2>
                <div id="authMessage"></div>
                <div class="input-group">
                    <label>Full Name</label>
                    <input type="text" id="regName" placeholder="Enter your name">
                </div>
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="regEmail" placeholder="Enter email">
                </div>
                <div class="input-group">
                    <label>Password</label>
                    <input type="password" id="regPassword" placeholder="Enter password">
                </div>
                <button class="btn btn-primary" id="registerBtn">Register</button>
                <div class="switch-text">
                    Already have an account? <span class="switch-link" id="showLoginBtn">Sign In</span>
                </div>
            </div>

            <div id="loginForm" class="hidden">
                <h2 class="auth-title">Sign In</h2>
                <div id="loginMessage"></div>
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="Enter email">
                </div>
                <div class="input-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter password">
                </div>
                <button class="btn btn-primary" id="loginBtn">Sign In</button>
                <div class="switch-text">
                    <span class="switch-link" id="forgotPasswordBtn">Forgot Password?</span>
                </div>
                <div class="switch-text">
                    Don't have an account? <span class="switch-link" id="showRegisterBtn">Register</span>
                </div>
            </div>
        </div>
    </div>

    <div class="dashboard" id="dashboard">
        <div class="header">
            <div class="header-top">
                <div class="brand">Hibt</div>
                <button class="btn-small" id="logoutBtn">Logout</button>
            </div>
            <div class="user-info-box">
                <div class="user-id">ID: <span id="userId"></span></div>
                <div class="user-name" id="userName"></div>
                <div class="balance-display">
                    <span id="userBalance">0.00</span> USDT
                    <div style="font-size: 14px; opacity: 0.9; margin-top: 5px;">Available Balance</div>
                </div>
                <div class="btn-group">
                    <button class="btn-small" id="profileBtn">Profile</button>
                    <button class="btn-small" id="contractBtn">My Contract</button>
                    <button class="btn-small" id="depositBtn">Deposit</button>
                    <button class="btn-small" id="analyticsBtn">Analytics</button>
                </div>
            </div>
        </div>

        <div class="market-section">
            <div class="section-header">
                <h2 class="section-title">Markets</h2>
            </div>
            <div class="coin-list" id="coinList"></div>
        </div>
    </div>

    <!-- Trading Modal -->
    <div class="modal" id="tradingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Trade</h2>
                <button class="close-btn" id="closeTradingBtn">&times;</button>
            </div>
            
            <div id="tradeMessage"></div>
            
            <div class="trade-section">
                <div class="trade-label">Direction</div>
                <div class="direction-btns">
                    <button class="direction-btn up" id="upBtn">Buy Up</button>
                    <button class="direction-btn down inactive" id="downBtn">Buy Down</button>
                </div>
            </div>

            <div class="trade-section">
                <div class="trade-label">Profit Percentage (Auto-set by time)</div>
                <div class="percentage-btns">
                    <button class="percentage-btn active" id="profit15" disabled style="opacity: 0.7;">15%</button>
                    <button class="percentage-btn" id="profit25" disabled style="opacity: 0.7;">25%</button>
                    <button class="percentage-btn" id="profit35" disabled style="opacity: 0.7;">35%</button>
                </div>
                <div class="info-text">Profit percentage is automatically set based on contract time</div>
            </div>

            <div class="trade-section">
                <div class="trade-label">Amount (USDT)</div>
                <input type="number" class="trade-input" id="tradeAmount" placeholder="Enter amount (min 100 USDT)" min="100">
                <div class="info-text">Available: <span id="availableBalance">0.00</span> USDT</div>
                <div class="info-text">Expected Profit: <span id="expectedProfit">0.00</span> USDT</div>
            </div>

            <div class="trade-section">
                <div class="trade-label">Contract Time</div>
                <select class="trade-input" id="timeFrame">
                    <option value="60">60 Seconds (15% Profit)</option>
                    <option value="90">90 Seconds (25% Profit) - Requires 100K+ Balance</option>
                    <option value="120">2 Minutes (35% Profit) - Requires 500K+ Balance</option>
                </select>
                <div class="info-text" id="timeFrameWarning" style="color: #f44336; display: none;">Insufficient balance for this timeframe</div>
            </div>

            <button class="trade-btn" id="executeTradeBtn">Execute Trade</button>
        </div>
    </div>

    <!-- History Modal -->
    <div class="modal" id="historyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">My Contract</h2>
                <button class="close-btn" id="closeHistoryBtn">&times;</button>
            </div>
            <div class="tab-container">
                <button class="tab active" id="waitTab">Wait</button>
                <button class="tab" id="finishedTab">Finished</button>
            </div>
            <div class="history-list" id="historyList"></div>
        </div>
    </div>

    <!-- Trade Detail Modal -->
    <div class="modal" id="tradeDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="detailCoinName">BTC/USDT</h2>
                <button class="close-btn" id="closeDetailBtn">&times;</button>
            </div>
            <div id="tradeDetailContent"></div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Profile</h2>
                <button class="close-btn" id="closeProfileBtn">&times;</button>
            </div>
            <div style="text-align: center; padding: 20px;">
                <div style="font-size: 18px; color: #666; margin-bottom: 10px;">UID: <span id="profileUserId"></span></div>
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 20px;" id="profileUserName"></div>
                <button class="btn btn-primary" id="viewDepositBtn">View Deposit</button>
                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef;">
                    <h3 style="margin-bottom: 15px;">Functions</h3>
                    <div style="text-align: left;">
                        <div style="padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="profileAnalyticsBtn">Analytics</div>
                        <div style="padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="changePasswordBtn">Change Password</div>
                        <div style="padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="contactSupportBtn">Contact Support</div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="settingsBtn">Settings</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div class="modal" id="depositModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Deposit Funds</h2>
                <button class="close-btn" id="closeDepositBtn">&times;</button>
            </div>
            <div style="padding: 20px 0;">
                <div class="trade-section">
                    <div class="trade-label">Select Cryptocurrency</div>
                    <select class="trade-input" id="depositCrypto">
                        <option value="btc">Bitcoin (BTC)</option>
                        <option value="eth">Ethereum (ETH)</option>
                        <option value="other">Other Coins</option>
                    </select>
                </div>

                <div class="trade-section">
                    <div class="trade-label">Deposit Address</div>
                    <div class="deposit-address" id="depositAddress">Select a cryptocurrency</div>
                    <button class="copy-btn" id="copyAddressBtn">Copy Address</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Change Password</h2>
                <button class="close-btn" id="closeChangePasswordBtn">&times;</button>
            </div>
            <div id="changePasswordMessage"></div>
            <div class="input-group">
                <label>Current Password</label>
                <input type="password" id="currentPassword" placeholder="Enter current password">
            </div>
            <div class="input-group">
                <label>New Password</label>
                <input type="password" id="newPassword" placeholder="Enter new password">
            </div>
            <div class="input-group">
                <label>Confirm New Password</label>
                <input type="password" id="confirmPassword" placeholder="Confirm new password">
            </div>
            <button class="btn btn-primary" id="submitChangePasswordBtn">Change Password</button>
        </div>
    </div>

    <!-- Chat Modal -->
    <div class="modal" id="chatModal">
        <div class="modal-content" style="max-width: 600px; height: 600px; display: flex; flex-direction: column;">
            <div class="modal-header">
                <h2 class="modal-title">Support Chat</h2>
                <button class="close-btn" id="closeChatBtn">&times;</button>
            </div>
            <div id="chatMessages" style="flex: 1; overflow-y: auto; padding: 15px; background: #f8f9fa; border-radius: 12px; margin-bottom: 15px;">
                <div style="text-align: center; color: #666; padding: 20px;">Loading messages...</div>
            </div>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="chatInput" placeholder="Type your message..." style="flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 12px;">
                <button class="btn btn-primary" style="width: auto; padding: 12px 24px; margin: 0;" id="sendMessageBtn">Send</button>
            </div>
        </div>
    </div>

    <!-- Analytics Modal -->
    <div class="modal" id="analyticsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Trading Analytics</h2>
                <button class="close-btn" id="closeAnalyticsBtn">&times;</button>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Trades</div>
                    <div class="stat-value" id="totalTrades">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Win Rate</div>
                    <div class="stat-value green" id="winRate">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Profit</div>
                    <div class="stat-value green" id="totalProfit">$0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Loss</div>
                    <div class="stat-value red" id="totalLoss">$0</div>
                </div>
            </div>
            <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 12px;">
                <h3 style="margin-bottom: 15px;">Performance Summary</h3>
                <div id="performanceChart" style="text-align: center; color: #666; padding: 20px;">Trade more to see detailed analytics</div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDWQBTrvvxCL5Qd23iSMTQlWkaPKZgjhqw",
            authDomain: "trading-dapp-d5aa4.firebaseapp.com",
            projectId: "trading-dapp-d5aa4",
            storageBucket: "trading-dapp-d5aa4.firebasestorage.app",
            messagingSenderId: "690266747119",
            appId: "1:690266747119:web:0f22d45fbee53ee3c3eb1a"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let currentUser = null;
        let userBalance = 0;
        let userName = '';
        let userId = '';
        let selectedCoin = null;
        let tradeDirection = 'up';
        let selectedPercentage = 15;
        let historyFilter = 'wait';
        let countdownIntervals = {};
        let balanceUpdateListener = null;
        let chatListener = null;

        const WALLET_ADDRESSES = {
            btc: "bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh",
            eth: "0x71C7656EC7ab88b098defB751B7401B5f6d8976F",
            other: "Contact support for other coins"
        };

        const coins = [
            { name: 'BTC', fullName: 'Bitcoin', class: 'btc', price: 109770.33 },
            { name: 'ETH', fullName: 'Ethereum', class: 'eth', price: 4030.81 },
            { name: 'XRP', fullName: 'Ripple', class: 'xrp', price: 2.8131 },
            { name: 'DOGE', fullName: 'Dogecoin', class: 'doge', price: 0.2309 },
            { name: 'ADA', fullName: 'Cardano', class: 'ada', price: 1.2456 },
            { name: 'BNB', fullName: 'Binance Coin', class: 'bnb', price: 692.45 },
            { name: 'SOL', fullName: 'Solana', class: 'sol', price: 245.67 },
            { name: 'LINK', fullName: 'Chainlink', class: 'link', price: 28.91 },
            { name: 'DOT', fullName: 'Polkadot', class: 'dot', price: 8.92 },
            { name: 'LTC', fullName: 'Litecoin', class: 'ltc', price: 156.78 }
        ];

        function generateUserId() {
            return Math.floor(10000 + Math.random() * 90000).toString();
        }

        function showMessage(elementId, message, type) {
            const el = document.getElementById(elementId);
            if (el) {
                el.innerHTML = '<div class="message ' + type + '">' + message + '</div>';
                setTimeout(function() { el.innerHTML = ''; }, 4000);
            }
        }

        function showRegister() {
            document.getElementById('registerForm').classList.remove('hidden');
            document.getElementById('loginForm').classList.add('hidden');
        }

        function showLogin() {
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('loginForm').classList.remove('hidden');
        }

        function showAuth() {
            document.getElementById('authContainer').style.display = 'flex';
            document.getElementById('dashboard').classList.remove('active');
        }

        function showDashboard() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('dashboard').classList.add('active');
            renderCoins();
        }

        async function register() {
            const name = document.getElementById('regName').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value + totalLoss.toFixed(2);

            } catch (error) {
                console.error('Error loading analytics:', error);
            }
        }

        function openChangePassword() {
            closeProfile();
            document.getElementById('changePasswordModal').classList.add('active');
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }

        function closeChangePassword() {
            document.getElementById('changePasswordModal').classList.remove('active');
        }

        async function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                showMessage('changePasswordMessage', 'Please fill all fields', 'error');
                return;
            }

            if (newPassword.length < 6) {
                showMessage('changePasswordMessage', 'New password must be at least 6 characters', 'error');
                return;
            }

            if (newPassword !== confirmPassword) {
                showMessage('changePasswordMessage', 'New passwords do not match', 'error');
                return;
            }

            try {
                const user = auth.currentUser;
                const credential = firebase.auth.EmailAuthProvider.credential(user.email, currentPassword);

                await user.reauthenticateWithCredential(credential);
                await user.updatePassword(newPassword);

                showMessage('changePasswordMessage', 'Password changed successfully!', 'success');
                setTimeout(function() {
                    closeChangePassword();
                }, 2000);
            } catch (error) {
                if (error.code === 'auth/wrong-password') {
                    showMessage('changePasswordMessage', 'Current password is incorrect', 'error');
                } else {
                    showMessage('changePasswordMessage', error.message, 'error');
                }
            }
        }

        function openChat() {
            closeProfile();
            document.getElementById('chatModal').classList.add('active');
            loadChatMessages();
        }

        function closeChat() {
            document.getElementById('chatModal').classList.remove('active');
            if (chatListener) {
                chatListener();
                chatListener = null;
            }
        }

        function loadChatMessages() {
            const chatMessages = document.getElementById('chatMessages');
            
            chatListener = db.collection('chats')
                .where('userId', '==', currentUser.uid)
                .orderBy('timestamp', 'asc')
                .onSnapshot(function(snapshot) {
                    if (snapshot.empty) {
                        chatMessages.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">No messages yet. Start a conversation!</div>';
                        return;
                    }

                    let html = '';
                    snapshot.forEach(function(doc) {
                        const msg = doc.data();
                        const isUser = msg.senderType === 'user';
                        const time = msg.timestamp ? new Date(msg.timestamp.toMillis()).toLocaleTimeString() : '';
                        
                        html += '<div style="margin-bottom: 15px; text-align: ' + (isUser ? 'right' : 'left') + ';">';
                        html += '<div style="display: inline-block; max-width: 70%; padding: 10px 15px; border-radius: 12px; background: ' + (isUser ? '#4285f4' : '#fff') + '; color: ' + (isUser ? '#fff' : '#333') + '; text-align: left; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">';
                        html += '<div style="font-weight: 600; font-size: 12px; margin-bottom: 5px; opacity: 0.8;">' + (isUser ? 'You' : 'Support') + '</div>';
                        html += '<div>' + msg.message + '</div>';
                        html += '<div style="font-size: 10px; margin-top: 5px; opacity: 0.7;">' + time + '</div>';
                        html += '</div></div>';
                    });

                    chatMessages.innerHTML = html;
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                });
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();

            if (!message) return;

            try {
                await db.collection('chats').add({
                    userId: currentUser.uid,
                    userIdNumber: userId,
                    userName: userName,
                    userEmail: currentUser.email,
                    message: message,
                    senderType: 'user',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    read: false
                });

                input.value = '';
            } catch (error) {
                console.error('Error sending message:', error);
            }
        }

        async function checkCompletedTrades() {
            if (!currentUser) return;

            try {
                const now = Date.now();
                const tradesSnapshot = await db.collection('trades')
                    .where('userId', '==', currentUser.uid)
                    .where('status', '==', 'pending')
                    .get();

                for (let i = 0; i < tradesSnapshot.docs.length; i++) {
                    const doc = tradesSnapshot.docs[i];
                    const trade = doc.data();
                    const tradeTime = trade.createdAt ? trade.createdAt.toMillis() : 0;
                    const endTime = tradeTime + (trade.timeFrame * 1000);

                    if (now >= endTime) {
                        const userDoc = await db.collection('users').doc(currentUser.uid).get();
                        const userMode = userDoc.exists ? (userDoc.data().tradingMode || 'loss') : 'loss';
                        
                        const winResult = userMode === 'win';
                        const profit = winResult ? trade.amount * (trade.percentage / 100) : 0;
                        const finalStatus = winResult ? 'win' : 'loss';

                        await db.collection('trades').doc(doc.id).update({
                            status: finalStatus,
                            profit: profit,
                            result: userMode
                        });

                        if (winResult && userDoc.exists) {
                            const currentBalance = userDoc.data().balance || 0;
                            const newBalance = currentBalance + trade.amount + profit;
                            await db.collection('users').doc(currentUser.uid).update({
                                balance: newBalance
                            });
                        }
                    }
                }
            } catch (error) {
                console.error('Error checking completed trades:', error);
            }
        }

        // Event Listeners
        document.getElementById('registerBtn').addEventListener('click', register);
        document.getElementById('loginBtn').addEventListener('click', login);
        document.getElementById('showLoginBtn').addEventListener('click', showLogin);
        document.getElementById('showRegisterBtn').addEventListener('click', showRegister);
        document.getElementById('forgotPasswordBtn').addEventListener('click', forgotPassword);
        document.getElementById('logoutBtn').addEventListener('click', logout);
        document.getElementById('profileBtn').addEventListener('click', openProfile);
        document.getElementById('contractBtn').addEventListener('click', openHistory);
        document.getElementById('depositBtn').addEventListener('click', openDeposit);
        document.getElementById('analyticsBtn').addEventListener('click', openAnalytics);
        document.getElementById('closeTradingBtn').addEventListener('click', closeTradeModal);
        document.getElementById('closeHistoryBtn').addEventListener('click', closeHistory);
        document.getElementById('closeDetailBtn').addEventListener('click', closeTradeDetail);
        document.getElementById('closeProfileBtn').addEventListener('click', closeProfile);
        document.getElementById('closeDepositBtn').addEventListener('click', closeDeposit);
        document.getElementById('closeAnalyticsBtn').addEventListener('click', closeAnalytics);
        document.getElementById('closeChangePasswordBtn').addEventListener('click', closeChangePassword);
        document.getElementById('closeChatBtn').addEventListener('click', closeChat);
        document.getElementById('upBtn').addEventListener('click', function() { selectDirection('up'); });
        document.getElementById('downBtn').addEventListener('click', function() { selectDirection('down'); });
        document.getElementById('executeTradeBtn').addEventListener('click', executeTrade);
        document.getElementById('waitTab').addEventListener('click', function() { switchHistoryTab('wait'); });
        document.getElementById('finishedTab').addEventListener('click', function() { switchHistoryTab('finished'); });
        document.getElementById('viewDepositBtn').addEventListener('click', function() { closeProfile(); openDeposit(); });
        document.getElementById('profileAnalyticsBtn').addEventListener('click', function() { closeProfile(); openAnalytics(); });
        document.getElementById('changePasswordBtn').addEventListener('click', openChangePassword);
        document.getElementById('contactSupportBtn').addEventListener('click', openChat);
        document.getElementById('settingsBtn').addEventListener('click', function() { alert('Settings - Coming Soon'); });
        document.getElementById('depositCrypto').addEventListener('change', updateDepositAddress);
        document.getElementById('copyAddressBtn').addEventListener('click', copyAddress);
        document.getElementById('submitChangePasswordBtn').addEventListener('click', changePassword);
        document.getElementById('sendMessageBtn').addEventListener('click', sendMessage);
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') sendMessage();
        });
        document.getElementById('tradeAmount').addEventListener('input', updateExpectedProfit);
        document.getElementById('timeFrame').addEventListener('change', updateTimeFrameAndProfit);

        auth.onAuthStateChanged(async function(user) {
            if (user) {
                currentUser = user;
                await loadUserData();
                showDashboard();
                setInterval(checkCompletedTrades, 5000);
            } else {
                currentUser = null;
                showAuth();
            }
        });
    </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hibt - Trading Platform</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f8f9fa; }
        
        .auth-container { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .auth-box { background: white; border-radius: 20px; padding: 40px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); width: 90%; max-width: 400px; }
        .auth-title { font-size: 24px; font-weight: 600; margin-bottom: 30px; text-align: center; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #555; font-weight: 500; }
        input, select { width: 100%; padding: 15px; border: 2px solid #e1e5e9; border-radius: 12px; font-size: 16px; }
        input:focus, select:focus { outline: none; border-color: #667eea; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 20px; }
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5a67d8; }
        .switch-text { margin-top: 20px; color: #6c757d; text-align: center; }
        .switch-link { color: #667eea; cursor: pointer; text-decoration: underline; }
        .message { padding: 10px; border-radius: 8px; margin-bottom: 15px; font-weight: 500; }
        .error { background: #fee; color: #c33; border: 1px solid #fcc; }
        .success { background: #efe; color: #363; border: 1px solid #cfc; }
        .hidden { display: none; }
        
        .dashboard { display: none; min-height: 100vh; }
        .dashboard.active { display: block; }
        .header { background: linear-gradient(135deg, #4285f4 0%, #3367d6 100%); color: white; padding: 20px; }
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .brand { font-size: 36px; font-weight: bold; }
        .user-info-box { background: rgba(255,255,255,0.2); padding: 15px; border-radius: 12px; margin-top: 15px; }
        .user-id { font-size: 14px; opacity: 0.9; margin-bottom: 5px; }
        .user-name { font-size: 18px; font-weight: 600; margin-bottom: 10px; }
        .balance-display { font-size: 32px; font-weight: bold; margin: 10px 0; }
        .btn-group { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .btn-small { padding: 8px 16px; background: rgba(255,255,255,0.2); border: none; border-radius: 20px; color: white; cursor: pointer; font-size: 14px; }
        .btn-small:hover { background: rgba(255,255,255,0.3); }
        
        .market-section { padding: 20px; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .section-title { font-size: 24px; font-weight: bold; }
        .coin-list { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .coin-item { display: flex; align-items: center; padding: 16px 20px; border-bottom: 1px solid #f1f3f4; cursor: pointer; }
        .coin-item:hover { background: #f8f9fb; }
        .coin-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; margin-right: 15px; font-size: 14px; }
        .coin-info { flex: 1; }
        .coin-name { font-weight: 600; font-size: 16px; }
        .coin-price { text-align: right; font-weight: 600; font-size: 16px; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto; }
        .modal.active { display: flex; justify-content: center; align-items: center; padding: 20px; }
        .modal-content { background: white; border-radius: 20px; padding: 30px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-title { font-size: 24px; font-weight: 600; }
        .close-btn { background: none; border: none; font-size: 32px; cursor: pointer; color: #666; line-height: 1; }
        .trade-section { margin-bottom: 20px; }
        .trade-label { font-weight: 600; margin-bottom: 10px; }
        .direction-btns { display: flex; gap: 10px; margin-top: 10px; }
        .direction-btn { flex: 1; padding: 15px; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; }
        .direction-btn.up { background: #4caf50; color: white; }
        .direction-btn.down { background: #f44336; color: white; }
        .direction-btn.inactive { background: #e9ecef; color: #666; }
        .percentage-btns { display: flex; gap: 10px; margin-top: 10px; }
        .percentage-btn { flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 12px; background: white; cursor: not-allowed; font-weight: 600; }
        .percentage-btn.active { background: #4285f4; color: white; border-color: #4285f4; }
        .trade-input { width: 100%; padding: 15px; border: 2px solid #e9ecef; border-radius: 12px; font-size: 16px; margin-top: 10px; }
        .info-text { color: #666; font-size: 14px; margin-top: 10px; }
        .trade-btn { width: 100%; padding: 18px; background: #4285f4; color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: 600; cursor: pointer; margin-top: 20px; }
        .trade-btn:hover { background: #3367d6; }
        
        .tab-container { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { flex: 1; padding: 12px; background: #f0f0f0; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
        .tab.active { background: #4285f4; color: white; }
        .history-list { margin-top: 20px; max-height: 400px; overflow-y: auto; }
        .history-item { background: white; padding: 15px; border-radius: 12px; margin-bottom: 10px; cursor: pointer; }
        .history-item.wait { border-left: 4px solid #ff9800; background: #fff8f0; }
        .history-item.finished.win { border-left: 4px solid #4caf50; background: #f1f8f4; }
        .history-item.finished.loss { border-left: 4px solid #f44336; background: #fef1f1; }
        .history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .history-coin { font-weight: 600; font-size: 16px; }
        .history-time { font-size: 12px; color: #666; }
        .countdown { font-size: 16px; font-weight: 600; color: #ff9800; }
        .history-profit { font-size: 14px; color: #4caf50; font-weight: 600; margin-top: 8px; }
        .history-loss { font-size: 14px; color: #f44336; font-weight: 600; margin-top: 8px; }
        .detail-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f0f0f0; }
        .detail-label { color: #666; }
        .detail-value { font-weight: 600; }
        .detail-value.up { color: #4caf50; }
        .detail-value.down { color: #f44336; }
        .detail-value.profit { color: #4caf50; font-size: 18px; }
        .detail-value.red { color: #f44336; font-size: 18px; }
        
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .stat-card { background: #f8f9fa; padding: 15px; border-radius: 12px; text-align: center; }
        .stat-label { font-size: 12px; color: #666; margin-bottom: 5px; }
        .stat-value { font-size: 24px; font-weight: bold; color: #333; }
        .stat-value.green { color: #4caf50; }
        .stat-value.red { color: #f44336; }
        
        .deposit-address { background: #f8f9fa; padding: 15px; border-radius: 12px; margin: 15px 0; word-break: break-all; font-family: monospace; font-size: 13px; border: 2px dashed #ddd; }
        .copy-btn { padding: 10px 20px; background: #4285f4; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
        .copy-btn:hover { background: #3367d6; }
        
        .btc { background: #f7931a; }
        .eth { background: #627eea; }
        .xrp { background: #23292f; }
        .doge { background: #c2a633; }
        .ada { background: #0033ad; }
        .bnb { background: #f3ba2f; }
        .sol { background: #9945FF; }
        .link { background: #375BD2; }
        .dot { background: #E6007A; }
        .ltc { background: #345D9D; }
    </style>
</head>
<body>
    <div class="auth-container" id="authContainer">
        <div class="auth-box">
            <div id="registerForm">
                <h2 class="auth-title">Create Account</h2>
                <div id="authMessage"></div>
                <div class="input-group">
                    <label>Full Name</label>
                    <input type="text" id="regName" placeholder="Enter your name">
                </div>
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="regEmail" placeholder="Enter email">
                </div>
                <div class="input-group">
                    <label>Password</label>
                    <input type="password" id="regPassword" placeholder="Enter password">
                </div>
                <button class="btn btn-primary" id="registerBtn">Register</button>
                <div class="switch-text">
                    Already have an account? <span class="switch-link" id="showLoginBtn">Sign In</span>
                </div>
            </div>

            <div id="loginForm" class="hidden">
                <h2 class="auth-title">Sign In</h2>
                <div id="loginMessage"></div>
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="Enter email">
                </div>
                <div class="input-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter password">
                </div>
                <button class="btn btn-primary" id="loginBtn">Sign In</button>
                <div class="switch-text">
                    <span class="switch-link" id="forgotPasswordBtn">Forgot Password?</span>
                </div>
                <div class="switch-text">
                    Don't have an account? <span class="switch-link" id="showRegisterBtn">Register</span>
                </div>
            </div>
        </div>
    </div>

    <div class="dashboard" id="dashboard">
        <div class="header">
            <div class="header-top">
                <div class="brand">Hibt</div>
                <button class="btn-small" id="logoutBtn">Logout</button>
            </div>
            <div class="user-info-box">
                <div class="user-id">ID: <span id="userId"></span></div>
                <div class="user-name" id="userName"></div>
                <div class="balance-display">
                    <span id="userBalance">0.00</span> USDT
                    <div style="font-size: 14px; opacity: 0.9; margin-top: 5px;">Available Balance</div>
                </div>
                <div class="btn-group">
                    <button class="btn-small" id="profileBtn">Profile</button>
                    <button class="btn-small" id="contractBtn">My Contract</button>
                    <button class="btn-small" id="depositBtn">Deposit</button>
                    <button class="btn-small" id="analyticsBtn">Analytics</button>
                </div>
            </div>
        </div>

        <div class="market-section">
            <div class="section-header">
                <h2 class="section-title">Markets</h2>
            </div>
            <div class="coin-list" id="coinList"></div>
        </div>
    </div>

    <!-- Trading Modal -->
    <div class="modal" id="tradingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Trade</h2>
                <button class="close-btn" id="closeTradingBtn">&times;</button>
            </div>
            
            <div id="tradeMessage"></div>
            
            <div class="trade-section">
                <div class="trade-label">Direction</div>
                <div class="direction-btns">
                    <button class="direction-btn up" id="upBtn">Buy Up</button>
                    <button class="direction-btn down inactive" id="downBtn">Buy Down</button>
                </div>
            </div>

            <div class="trade-section">
                <div class="trade-label">Profit Percentage (Auto-set by time)</div>
                <div class="percentage-btns">
                    <button class="percentage-btn active" id="profit15" disabled style="opacity: 0.7;">15%</button>
                    <button class="percentage-btn" id="profit25" disabled style="opacity: 0.7;">25%</button>
                    <button class="percentage-btn" id="profit35" disabled style="opacity: 0.7;">35%</button>
                </div>
                <div class="info-text">Profit percentage is automatically set based on contract time</div>
            </div>

            <div class="trade-section">
                <div class="trade-label">Amount (USDT)</div>
                <input type="number" class="trade-input" id="tradeAmount" placeholder="Enter amount (min 100 USDT)" min="100">
                <div class="info-text">Available: <span id="availableBalance">0.00</span> USDT</div>
                <div class="info-text">Expected Profit: <span id="expectedProfit">0.00</span> USDT</div>
            </div>

            <div class="trade-section">
                <div class="trade-label">Contract Time</div>
                <select class="trade-input" id="timeFrame">
                    <option value="60">60 Seconds (15% Profit)</option>
                    <option value="90">90 Seconds (25% Profit) - Requires 100K+ Balance</option>
                    <option value="120">2 Minutes (35% Profit) - Requires 500K+ Balance</option>
                </select>
                <div class="info-text" id="timeFrameWarning" style="color: #f44336; display: none;">Insufficient balance for this timeframe</div>
            </div>

            <button class="trade-btn" id="executeTradeBtn">Execute Trade</button>
        </div>
    </div>

    <!-- History Modal -->
    <div class="modal" id="historyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">My Contract</h2>
                <button class="close-btn" id="closeHistoryBtn">&times;</button>
            </div>
            <div class="tab-container">
                <button class="tab active" id="waitTab">Wait</button>
                <button class="tab" id="finishedTab">Finished</button>
            </div>
            <div class="history-list" id="historyList"></div>
        </div>
    </div>

    <!-- Trade Detail Modal -->
    <div class="modal" id="tradeDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="detailCoinName">BTC/USDT</h2>
                <button class="close-btn" id="closeDetailBtn">&times;</button>
            </div>
            <div id="tradeDetailContent"></div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Profile</h2>
                <button class="close-btn" id="closeProfileBtn">&times;</button>
            </div>
            <div style="text-align: center; padding: 20px;">
                <div style="font-size: 18px; color: #666; margin-bottom: 10px;">UID: <span id="profileUserId"></span></div>
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 20px;" id="profileUserName"></div>
                <button class="btn btn-primary" id="viewDepositBtn">View Deposit</button>
                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef;">
                    <h3 style="margin-bottom: 15px;">Functions</h3>
                    <div style="text-align: left;">
                        <div style="padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="profileAnalyticsBtn">Analytics</div>
                        <div style="padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="changePasswordBtn">Change Password</div>
                        <div style="padding: 15px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="contactSupportBtn">Contact Support</div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" id="settingsBtn">Settings</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div class="modal" id="depositModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Deposit Funds</h2>
                <button class="close-btn" id="closeDepositBtn">&times;</button>
            </div>
            <div style="padding: 20px 0;">
                <div class="trade-section">
                    <div class="trade-label">Select Cryptocurrency</div>
                    <select class="trade-input" id="depositCrypto">
                        <option value="btc">Bitcoin (BTC)</option>
                        <option value="eth">Ethereum (ETH)</option>
                        <option value="other">Other Coins</option>
                    </select>
                </div>

                <div class="trade-section">
                    <div class="trade-label">Deposit Address</div>
                    <div class="deposit-address" id="depositAddress">Select a cryptocurrency</div>
                    <button class="copy-btn" id="copyAddressBtn">Copy Address</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Change Password</h2>
                <button class="close-btn" id="closeChangePasswordBtn">&times;</button>
            </div>
            <div id="changePasswordMessage"></div>
            <div class="input-group">
                <label>Current Password</label>
                <input type="password" id="currentPassword" placeholder="Enter current password">
            </div>
            <div class="input-group">
                <label>New Password</label>
                <input type="password" id="newPassword" placeholder="Enter new password">
            </div>
            <div class="input-group">
                <label>Confirm New Password</label>
                <input type="password" id="confirmPassword" placeholder="Confirm new password">
            </div>
            <button class="btn btn-primary" id="submitChangePasswordBtn">Change Password</button>
        </div>
    </div>

    <!-- Chat Modal -->
    <div class="modal" id="chatModal">
        <div class="modal-content" style="max-width: 600px; height: 600px; display: flex; flex-direction: column;">
            <div class="modal-header">
                <h2 class="modal-title">Support Chat</h2>
                <button class="close-btn" id="closeChatBtn">&times;</button>
            </div>
            <div id="chatMessages" style="flex: 1; overflow-y: auto; padding: 15px; background: #f8f9fa; border-radius: 12px; margin-bottom: 15px;">
                <div style="text-align: center; color: #666; padding: 20px;">Loading messages...</div>
            </div>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="chatInput" placeholder="Type your message..." style="flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 12px;">
                <button class="btn btn-primary" style="width: auto; padding: 12px 24px; margin: 0;" id="sendMessageBtn">Send</button>
            </div>
        </div>
    </div>

    <!-- Analytics Modal -->
    <div class="modal" id="analyticsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Trading Analytics</h2>
                <button class="close-btn" id="closeAnalyticsBtn">&times;</button>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Trades</div>
                    <div class="stat-value" id="totalTrades">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Win Rate</div>
                    <div class="stat-value green" id="winRate">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Profit</div>
                    <div class="stat-value green" id="totalProfit">$0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Loss</div>
                    <div class="stat-value red" id="totalLoss">$0</div>
                </div>
            </div>
            <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 12px;">
                <h3 style="margin-bottom: 15px;">Performance Summary</h3>
                <div id="performanceChart" style="text-align: center; color: #666; padding: 20px;">Trade more to see detailed analytics</div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
